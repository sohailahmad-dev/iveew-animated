"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const node_fs_1 = tslib_1.__importDefault(require("node:fs"));
const node_path_1 = tslib_1.__importDefault(require("node:path"));
const environment_1 = require("../__helpers__/environment");
const oclif_runner_1 = require("../__helpers__/oclif-runner");
const TEST_ENV_PATH = "production";
describe("prod", () => {
    const configurations = [
        ["typescript", "analytics-node", "segment.ts"],
        ["typescript", "analytics-js", "segment.ts"],
    ];
    for (const config of configurations) {
        const [language, sdk, filename, plan, id, outputPath, legacyId] = config;
        it(`builds production client Language: ${language}, SDK:${sdk}`, async () => {
            const testPath = await (0, environment_1.setupEnv)(TEST_ENV_PATH, language, sdk, plan, id, outputPath, legacyId);
            await (0, oclif_runner_1.run)(["production", "-c", testPath]);
            const output = node_fs_1.default
                .readFileSync(node_path_1.default.join(testPath, filename), {
                encoding: "utf-8",
            })
                .replace(/version:.*\d.*/g, "");
            expect(output).toMatchSnapshot();
        });
    }
});
